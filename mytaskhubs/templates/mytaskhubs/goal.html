{% extends "mytaskhubs/base.html" %}

{% block content %}
  <h2>{{ goal.title }}</h2>
  <p>{{ goal.description }}</p>
  <p><strong>Prazo final:</strong> {{ goal.end_date|date:"d/m/Y H:i" }}</p>

  <!-- Formulário para marcar tarefas como concluídas -->
  <form method="post" action="{% url 'goal' goal.id %}">
    {% csrf_token %}
    <ul style="list-style: none; padding: 0;">
      {% for task in goal.tasks.all %}
        <li style="margin-bottom: 8px;">
          <label>
            <input type="checkbox" name="task_{{ task.id }}" {% if task.completed %}checked{% endif %} onchange="this.form.submit()">
            {{ task.title }}
          </label>
        </li>
      {% empty %}
        <li>Sem tarefas ainda.</li>
      {% endfor %}
    </ul>
  </form>

  <h4>Progresso:</h4>
  <div style="margin-bottom: 10px;">
    <progress value="{{ goal.progress }}" max="100" style="width: 100%; height: 20px;"></progress>
    <p>{{ goal.progress }}% concluído</p>
  </div>

  <a href="{% url 'add_task_to_goal' goal.id %}">Adicionar nova task</a>

{% endblock %}
